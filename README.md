Will be rewritten to C++